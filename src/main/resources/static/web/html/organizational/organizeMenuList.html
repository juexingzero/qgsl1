<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>组织架构栏目</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />

<script src="/resources/miniui/scripts/boot.js" type="text/javascript"></script>
</head>
<style>
body {
	background: #FFFFFF;
}
</style>
<style type="text/css">
html, body {
	padding: 0;
	margin: 0;
	border: 0;
	width: 100%;
	height: 100%;
	overflow: hidden;
}
</style>
<body>
	<!-- 部门 -->
	
	
	   <div class="mini-fit">
        
        <ul id="tree1" class="mini-tree" style="width:100%;height:100%;" url="/organ/deptMenuLists"
            showTreeIcon="true" textField="dept_name" idField="dept_id" parentField="p_dept_id" resultAsTree="false"  
            expandOnLoad="true" onnodedblclick="onNodeDblClick" expandOnDblClick="false" 
            >
        </ul>
    
    </div> 
    
    
	<div class="mini-toolbar"
		style="text-align: center; padding-top: 8px; padding-bottom: 8px;"
		borderStyle="border-left:0;border-bottom:0;border-right:0;">
		<a class="mini-button" style="width: 60px;" onclick="onOk()">确定</a> <span
			style="display: inline-block; width: 5px;"></span> <a
			class="mini-button" style="width: 60px;" onclick="onCancel()">取消</a>
	</div>
</body>
<script type="text/javascript">
	mini.parse();

	var tree = mini.get("tree1");

	tree.load();

	function GetData() {
		var node = tree.getSelectedNode();
		return node;
	}
	/* 	function search() {
	 var key = mini.get("key").getValue();
	 if (key == "") {
	 tree.clearFilter();
	 } else {
	 key = key.toLowerCase();
	 tree.filter(function(node) {
	 var text = node.text ? node.text.toLowerCase() : "";
	 if (text.indexOf(key) != -1) {
	 return true;
	 }
	 });
	 }
	 } */
	function onKeyEnter(e) {
		search();
	}
	function onNodeDblClick(e) {
		onOk();
	}
	//////////////////////////////////
	function CloseWindow(action) {
		if (window.CloseOwnerWindow)
			return window.CloseOwnerWindow(action);
		else
			window.close();
	}

	function onOk() {
		var node = tree.getSelectedNode();
		 if (node && tree.getLevel (node)==1) {
			alert("部门最多支持二级");
			return;
		  } 

		CloseWindow("ok");
	}
	function onCancel() {
		CloseWindow("cancel");
	}
</script>
</html>
